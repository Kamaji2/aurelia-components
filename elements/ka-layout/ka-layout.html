<template>
  <header if.bind="initialized">
    <div class="ka-layout-burger" click.trigger="toggle()" ref="burgerHeader">
      <i class="fa-solid fa-bars"></i>
    </div>
    <div if.bind="config.brand" class="ka-layout-brand">
      <img src="${config.brand}">
    </div>
  </header>

  <aside>
    <header if.bind="initialized">
      <div class="ka-layout-burger" click.trigger="toggle()" ref="burgerAside">
        <i class="fa-solid fa-arrow-left-from-line"></i>
      </div>
      <div if.bind="config.brand" class="ka-layout-brand">
        <img src="${config.brand}">
      </div>
    </header>

    <slot name="beforeNav"></slot>

    <!-- Aside menÃ¹ -->
    <nav if.bind="initialized && config.navigation.items.length">
      <!-- Level 01 -->
      <ul>
        <template repeat.for="item of config.navigation.items">
          <li if.bind="!item.hidden" class="${item.collapsed?'collapsed':''} ${item.nav.length?'hasNav':''} ${router.currentInstruction.config.href === item.href ? 'isSelected' : ''}">
            <div>
              <i if.bind="item.icon" class="item-icon ${item.icon}"></i>
              <span class="item-label">${item.label}</span>
              <i if.bind="item.nav.length" class="item-toggler fa-solid fa-caret-down fa-rotate-by" click.trigger="toggleItem(item)"></i>
              <b if.bind="item.badge && item.badge.value" class="item-badge">${item.badge.value}</b>

              <template if.bind="!item.nav.length">
                <a if.bind="item.href" href="${item.href}" class="item-link"></a>
                <a if.bind="!item.href && item.callback && callbacks[item.callback]" href="#" class="item-link" click.trigger="callbacks[item.callback]()"></a>
              </template>
              <a else href="#" class="item-link" click.trigger="toggleItem(item)"></a>

            </div>

            <!-- Level 02 -->
            <ul if.bind="item.nav.length">
              <template repeat.for="item of item.nav">
                <li if.bind="!item.hidden" class="${item.collapsed?'collapsed':''} ${item.nav.length?'hasNav':''} ${router.currentInstruction.config.href === item.href ? 'isSelected' : ''}">
                  <div>
                    <i if.bind="item.icon" class="item-icon ${item.icon}"></i>
                    <span class="item-label">${item.label}</span>
                    <i if.bind="item.nav.length" class="item-toggler fa-solid fa-caret-down fa-rotate-by" click.trigger="toggleItem(item)"></i>
                    <b if.bind="item.badge && item.badge.value" class="item-badge">${item.badge.value}</b>
                    <template if.bind="!item.nav.length">
                      <a if.bind="item.href" href="${item.href}" class="item-link"></a>
                      <a if.bind="!item.href && item.callback && callbacks[item.callback]" href="#" class="item-link" click.trigger="callbacks[item.callback]()"></a>
                    </template>
                    <a else href="#" class="item-link" click.trigger="toggleItem(item)"></a>
                  </div>

                  <!-- Level 03 -->
                  <ul if.bind="item.nav.length">
                    <template repeat.for="item of item.nav">
                      <li if.bind="!item.hidden" class="${router.currentInstruction.config.href === item.href ? 'isSelected' : ''}">
                        <div>
                          <i if.bind="item.icon" class="item-icon ${item.icon}"></i>
                          <span class="item-label">${item.label}</span>
                          <b if.bind="item.badge && item.badge.value" class="item-badge">${item.badge.value}</b>
                          <a if.bind="item.href" href="${item.href}" class="item-link"></a>
                          <a if.bind="!item.href && item.callback && callbacks[item.callback]" href="#" class="item-link" click.trigger="callbacks[item.callback]()"></a>
                        </div>
                      </li>
                    </template>
                  </ul>
                </li>
              </template>
            </ul>
          </li>
        </template>
      </ul>
    </nav>

    <slot name="afterNav"></slot>

    
  </aside>


  <div id="ka-layout-loader" ref="loader">
    <div></div>
    <span if.bind="loaderMessage">${loaderMessage}</span>
  </div>
</template>
